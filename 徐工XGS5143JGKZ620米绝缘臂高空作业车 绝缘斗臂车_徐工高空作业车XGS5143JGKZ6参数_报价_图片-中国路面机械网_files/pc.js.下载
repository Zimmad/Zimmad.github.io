function start(){
    
    if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){
        $('head meta[name=mobile-agent]').each(function(){
            var murl = '' ;
            murl = $(this).attr('content') ;
            murl = murl.replace(/format=html5;url=/g,"");
            murl = murl.replace(/format=xhtml;url=/g,"");
            if(!murl) return ;
            
            window.location.href = murl ;
            return false ;
        }) ;
    }

    if($(window).width() < 1430) $('body').addClass('w1200') ;
    $('img').lazyload({effect: 'fadeIn',threshold:50});
    
    $('.tomoreshow').bind('click',function(){
        var to = $(this).attr('toshow') ;
        $(this).parent().find('.'+to).show() ;
    }) ;
    
    function tmcatesIn(topms){
        topms.find('.classify-nav a').each(function(i){
            $(this).attr('ii',i);
        }) ;
        topms.find('.classify-nav a').bind('mouseover',function(){
            $(this).siblings().removeClass('current') ;
            $(this).addClass('current') ;
            var ii = $(this).attr('ii') ;
            
            $(topms.find('.content')[ii]).find('img').each(function(){
                if(!$(this).attr('src')) $(this).attr('src',$(this).attr('_src')) ;
            }) ;
            
            $(topms.find('.content')[ii]).siblings('.content').hide() ;
            $(topms.find('.content')[ii]).show() ;
        }) ;
        
    }
    
    var xGetclassifyxing = false ;
    $('.header .categorys .a').bind('mouseover',function(){
        if(xGetclassifyxing) return ;
        
        
        if(!$(this).parent().find('.classify')[0]){
            var that = this ;
            xGetclassifyxing = true ;
            $.get('/z5/tpls/tmcates',{},function(html){
                var topms = $(html) ;
                $(that).parent().append(topms) ;
                tmcatesIn(topms) ;
                xGetclassifyxing = false ;
            }) ;
        }
    }) ;
    
    
    var xGettopsitemapsxing = false ;
    $('.topbar .sitemap .sitemapa').bind('mouseover',function(){
        if(xGettopsitemapsxing) return ;
        
        
        if(!$(this).parent().find('.sitemapin')[0]){
            var that = this ;
            xGettopsitemapsxing = true ;
            $.get('/z5/tpls/tmsitemaps',{},function(html){
                var topms = $(html) ;
                $(that).parent().append(topms) ;
                xGettopsitemapsxing = false ;
            }) ;
        }
        
    }) ;
    
    
    
    if(window.VP == 'list') start_list() ;
    else if(window.VP == 'detail') start_detail() ;
    else if(window.VP == 'company') start_company() ;
    
    window._pageLoad && window._pageLoad() ;

    if(window._pageLoads && window._pageLoads){
        for(var i=0;i<window._pageLoads.length;i++){
            window._pageLoads[i]() ;
        }
    }


    //最近浏览及统计
    stat() ;

    //右侧工具条
    rtools() ;
  
    new Sosuggest('#input-keyword') ;
}


function rtools(){
    //返回顶部
    $('.backtop').click(function(){
        $('html,body').animate({scrollTop:0},'slow') ;
    }) ;
    

    var showfeedback = function(){
        if(feedbackdoom) return feedbackdoom.show() ;
    
        feedbackdoom = $('<div class="popupseek"><div class="popupseekcover"></div><div class="popupseekcon"><div class="tit"><i class="ticon ticonl"></i>您正在找<i class="ticon ticonr"></i></div><div class="text"><span>如没有找到您要寻找的内容，也请留下您的姓名电话，</span> <span>我们会第一时间联系您！</span></div><div class="seeklist cl"><a href="javascript:;" class="item item1"><i></i>报价</a><a href="javascript:;" class="item item2"><i></i>图片</a><a href="javascript:;" class="item item3"><i></i>参数配置</a><a href="javascript:;" class="item item4"><i></i>售后</a><a href="javascript:;" class="item item5"><i></i>机械故障</a><a href="javascript:;" class="item item6"><i></i>其他</a></div><div class="contentinput"><label>留言：</label><textarea class="popupseek_input_content"></textarea></div><div class="lcontact"><div class="item"><label for="">姓名：</label><input type="text" class="popupseek_input_name" placeholder=""></div><div class="item"><label for="">联系电话：</label><input type="text" class="popupseek_input_phone" placeholder=""></div><input type="button" value="提交反馈" class="submit"></div><a href="javascript:;" class="close"></a></div></div>') ;
        $('body').append(feedbackdoom) ;
        
        feedbackdoom.find('.seeklist .item').bind('click',function(){
            feedbackdoom.find('.seeklist .item').removeClass('current') ;
            $(this).addClass('current') ;
        }) ;
        
        feedbackdoom.find('.close').bind('click',function(){
            feedbackdoom.hide() ;
        }) ;
        
        
        var xsubmiting = false ;
        feedbackdoom.find('.submit').bind('click',function(){
            if(xsubmiting) return ;
            
            var pdata = {} ;
            pdata.stype = feedbackdoom.find('.seeklist .item.current').text() ;
            pdata.name = feedbackdoom.find('.popupseek_input_name').val() ;
            pdata.phone = feedbackdoom.find('.popupseek_input_phone').val() ;
            pdata.content = feedbackdoom.find('.popupseek_input_content').val() ;
            
            if(!pdata.stype){
                dialog.show('请选择要反馈的类型!') ;
                return ;
            }
            
            if(!pdata.name){
                dialog.show('请填写您的姓名!') ;
                return ;
            }
            
            xsubmiting = true ;
            $.post('/z5/api/feedback',pdata,function(js){
                xsubmiting = false ;
                if(!js || !js.code){
                    dialog.show('网络错误，请重试!') ;
                    return ;
                }
                
                if(js.code != '200'){
                    var msg = '网络错误，请重试' ;
                    if(js.msg) msg = js.msg ;
                    dialog.show(msg) ;
                    return ;
                }
                
                feedbackdoom.hide() ;
                dialog.show('感谢您的反馈！') ;
                
            },'json') ;
            
            xsubmiting = true ;
            
        }) ;

        feedbackdoom.show() ;
    }
    //意见反馈
    var feedbackdoom = null ;
    $('.contrast .feedback').click(function(){
        showfeedback();
    }) ;
    

    $('.ltoolsbar .feedback').click(function(){
        showfeedback();
    }) ;
}


function start_list(){
    //谷歌翻译
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://u-static.lmjx.net/2020/googletranslate/element.js?cb=googleTranslateElementInit";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();


    pkbar() ;
    

    $('.itempk input').bind('change',function(){
        var item = { } ;
        item.id = $(this).attr('data-id') ;
        item.icon = $(this).attr('data-icon') ;
        item.cname = $(this).attr('data-cname') ;
        item.model = $(this).attr('data-model') ;
        item.url = $(this).attr('data-url') ;
        item.cate_id = $(this).attr('data-cate_id') ;
        item.cate_name = $(this).attr('data-cate_name') ;
        
        if($(this).attr('checked')){
            var result = pktools.add(item.id,item.icon,item.cname,item.model,item.url,item.cate_id,item.cate_name) ;
            if(!result) $(this).attr('checked',false) ;
        }else{
            var result = pktools.sub(item.id,item.cate_id) ;
            if(!result) $(this).attr('checked',true) ;
        }
    }) ;
    
    //多项选择
    var lastSelectedLindex = '' ;
    $('.mms_companys .lindexs a').bind('click',function(){
        if($(this).hasClass('disabled')) return false ;
        var lindex = $(this).text() ;
        if(lastSelectedLindex == lindex){
            $(this).removeClass('current') ;
            $('.mms_companys .companys a').show() ;
            lastSelectedLindex = '' ;
            return false ;
        }
            
        lastSelectedOrigin = '' ;
        $('.mms_companys .mc a').removeClass('current') ;
        
        if($(this).hasClass('reseta')){
            $('.mms_companys .companys a').show() ;
            lastSelectedLindex = '' ;
            return false ;
        }
        
        $('.mms_companys .lindexs a').removeClass('current') ;
        $(this).addClass('current') ;
        lastSelectedLindex = lindex ;
        $('.mms_companys .companys a').hide() ;
        $('.mms_companys .companys a[lindex='+lindex+']').show() ;
        
        return false ;
    }) ;


    var lastSelectedOrigin = '' ;
    $('.mms_companys .mc a').bind('click',function(){
        if(!$(this).attr('origin')) return true ;
        
        var origin = $(this).attr('origin') ;
        if(lastSelectedOrigin == origin){
            $(this).removeClass('current') ;
            $('.mms_companys .companys a').show() ;
            lastSelectedOrigin = '' ;
            return false ;
        }
        
        lastSelectedLindex = '' ;
        $('.mms_companys .lindexs a').removeClass('current') ;
        
        $('.mms_companys .mc a').removeClass('current') ;
        $(this).addClass('current') ;
        lastSelectedOrigin = origin ;
        $('.mms_companys .companys a').hide() ;
        $('.mms_companys .companys a[origin='+origin+']').show() ;
        
        return false ;
    }) ;
    
    $('.select_mms .expand').bind('click',function(){
        var too = $(this).hasClass('expand_close') ? 'open' : 'close' ;
        var roo = too == 'close' ? 'open' : 'close' ;
        
        $('.select_mms .mms_companys').removeClass('mms_companys_' + roo).addClass('mms_companys_' + too) ;
        $(this).removeClass('expand_' + roo).addClass('expand_' + too) ;
    }) ;
    
    
    if($('.select_mms .mms_companys .companys .current')[0]){
        var oHeight = 76 ;
        if($('.select_mms .mms_companys').hasClass('mms_companys_4')) oHeight = 142 ;
        if($('.select_mms .mms_companys').hasClass('mms_companys_3')) oHeight = 109 ;
        
        var oTop = $('.select_mms .mms_companys .companys .current').position().top ;
        if(oTop > oHeight){
            $('.select_mms .mms_companys').removeClass('mms_companys_close').addClass('mms_companys_open') ;
            $('.select_mms .expand').removeClass('expand_close').addClass('expand_open') ;
            $('.select_mms .mms_companys .companys').scrollTop(oTop - 66 - 10) ;
        }
    }
    
    //展开
    if($('.select_mms .mms_companys .companys a:last')[0] && $('.select_mms .mms_companys .companys a:last').position().top < $('.select_mms .mms_companys .companys').height()){
        $('.select_mms .expand').hide() ;
    }
    
    //上一页，下一页
    var prevpurl = '' ;
    var nextpurl = '' ;
    $('.pages a.nextprev').each(function(){
        if($(this).text().indexOf('上一页') > -1) prevpurl = $(this).attr('href') ;
        if($(this).text().indexOf('下一页') > -1) nextpurl = $(this).attr('href') ;
    }) ;
    
    if(prevpurl) $('.product_bar_prev').attr('href',prevpurl) ;
    else $('.product_bar_prev').hide() ;
    if(nextpurl) $('.product_bar_next').attr('href',nextpurl) ;
    else $('.product_bar_next').hide() ;

    $('.awww_relsmore').bind('click',function(){
        var too = $(this).hasClass('expand_close') ? 'open' : 'close' ;
        var roo = too == 'close' ? 'open' : 'close' ;
        $(this).removeClass('expand_' + roo).addClass('expand_' + too) ;
        
        if(too == 'open'){
            $('.www_rels').removeClass('www_rels_max') ;
        }else{
            $('.www_rels').addClass('www_rels_max') ;
        }
    });

}

function start_detail(){
    if(window._FOLLOWPRODUCT){
    var productfollow = {} ;
    productfollow.is = false ;
    productfollow.doa = function(){
        $('#_follow_product_box_sms_send').addClass('textgray');
        $('#_follow_product_box_sms_send').text(productfollow.doatime+'秒');
        
        productfollow.doatime-- ;
        if(productfollow.doatime < 1){
            $('#_follow_product_box_sms_send').removeClass('textgray');
            $('#_follow_product_box_sms_send').text('获取验证码');
            clearInterval(productfollow.timex) ;
        }
    }
    productfollow.getonline = function(){
        iapi.post('v5/online/detail',{} , {
            succ : function(js){
                if(!js.online) return false ;
                productfollow.online = js.online ;

                $('#_follow_product_box .itcode').hide();
                if(!$('#_follow_product_box_name').val()){
                    var name = js.online.truename?js.online.truename:js.online.name; 
                    if(b.Cookies.get('ak_name')){
                        name = b.Cookies.get('ak_name');
                    }
                    
                    $('#_follow_product_box_name').val(name);
                }
                if(!$('#_follow_product_box_phone').val()){
                    var phone = js.online.uname ; 
                    if(b.Cookies.get('ak_phone')){
                        phone = b.Cookies.get('ak_phone');
                    }
                    
                    $('#_follow_product_box_phone').val(phone);
                }
            },
            ever : function(){
                
            }
        }) ;
    }
    
    $(function(){
        iapi.post('v5/productfollow/is',{product_id:window._FOLLOWPRODUCT.id+''} , {
            succ : function(js){
                if(js && js.isfollow == 1){
                    productfollow.is = true ;
                    $('#_follow_product').html('√ 已关注');
                }
            },
            ever : function(){
                
            }
        }) ;
        
        if(login.is()){
            productfollow.getonline();
        }
    });
    
    
    $('#_follow_product').click(function(){
        if(productfollow.is) return false; 
        
        if(login.is()) return doproductfollow();
        
        $('#_follow_product_box').show();
        return false ;
    });
    
    $('#_follow_product_box .close').click(function(){
        $('#_follow_product_box').hide();
        return false ;
    });
    
    $('#_follow_product_box_sms_send').click(function(){
        if(productfollow.doatime >= 1) return false ;
        if(productfollow.xcoding) return ;
        
        var phone = $('#_follow_product_box_phone').val() ;
        if(!phone){
            dialog.show('请输入手机号') ;
            return false ;
        }
        
        if(!/^[1][0-9]{10}$/.test(phone)){
            dialog.show('请输入正确的手机号') ;
            return false ;
        }
        
        productfollow.xcoding = true ;
        iapi.post('account/smscaptcha',{ phone:phone,to:'smslogin'} , {
            succ : function(js){
                productfollow.doatime = 60 ;
                productfollow.timex = setInterval(productfollow.doa,1000) ;
                productfollow.doa() ;
            },
            ever : function(){
                productfollow.xcoding = false ;
            }
        }) ;
    }) ;
    
    $('#_follow_product_box_sms_submit').click(function(){
        var phone = $('#_follow_product_box_phone').val() ;
        var sms = $('#_follow_product_box_sms').val() ;
        if(!sms && login.is()){
            if(phone != productfollow.online.uname){
                $('#_follow_product_box .itcode').show() ;
                dialog.show('请输入验证码') ;
                return false ;
            }
            
            return doproductfollow();
        }
        
        if(productfollow.xing) return ;

        var name = $('#_follow_product_box_name').val() ;
        if(!name){
            return dialog.show('请输入姓名') ;
        }
        
        if(!phone){
            return dialog.show('请输入手机号') ;
        }
        
        if(!sms){
            return dialog.show('请输入验证码') ;
        }
        
        var post = { uname: phone , smscaptcha: sms } ;
        
        productfollow.xing = true ;
        loading.show() ;
        iapi.post('account/smsloginregister',post , {
            succ : function(js){
                if(!js.skey) return false ;
                $('#_follow_product_box_sms').val('') ;
                
                localStorage.setItem('lcenter_jyh_sky', js.skey) ;
                
                dialog.show('关注成功',function(){
                    login.hide() ;
                    dialog.hide() ;
                }) ;
                
                doproductfollow() ;
                productfollow.getonline();
            },
            ever : function(){
                productfollow.xing = false ;
                loading.hide() ;
            }
        }) ;
    });
    
    function doproductfollow(){
         if(productfollow.is) return false ;
        //询价 .
        var post = {} ;
        post.name = $('#_follow_product_box_name').val() ;
        post.phone = $('#_follow_product_box_phone').val() ;
        
        if(!post.name) return dialog.show('请输入姓名') ;
        if(!post.phone) return dialog.show('请输入手机号') ;

        post.title = '【关注】我想对' + window._FOLLOWPRODUCT.title +'询价'; 
        
        post.product_id = window._FOLLOWPRODUCT.id +'';
        post.mphonebyarea = 1; 
        $.post('/z5/askp/post',post,function(js){ },'json') 
        
       var cdate = new Date();
        cdate.setTime(cdate.getTime() + (86400 * 1000 * 1000));
        
        var cks = ['name','phone'] ;
        for(var i=0;i<cks.length;i++){
            var k = cks[i] ;
            if(typeof post[k] == 'undefined') continue ;
            b.Cookies.set('ak_' + k,post[k],cdate,'/','.lmjx.net',true) ;
        }
      
        //请求关注
        var xpost = {} ;
        xpost.title = window._FOLLOWPRODUCT.title +'' ; 
        xpost.icon = window._FOLLOWPRODUCT.icon +'' ; 
        xpost.company_id = window._FOLLOWPRODUCT.company_id +'' ;
        xpost.cate_1 = window._FOLLOWPRODUCT.cate_1 +'' ;
        xpost.cate_2 = window._FOLLOWPRODUCT.cate_2 +'' ;
        xpost.product_id = window._FOLLOWPRODUCT.id +'' ;
        xpost.name = $('#_follow_product_box_name').val() ;
        xpost.phone = $('#_follow_product_box_phone').val() ;
        iapi.post('v5/productfollow/add',xpost, {
            succ : function(js){
                productfollow.is = true ;
                $('#_follow_product').html('√ 已关注');
                $('#_follow_product_box').hide();
            },
            ever : function(){
                $('#_follow_product_box').hide();
            }
        }) ;
    }
}
    
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://u-static.lmjx.net/2020/googletranslate/element.js?cb=googleTranslateElementInit";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();

    var b = xbase() ;
    
    var askpdi = {} ;
    askpdi.callbacks = {} ;
    askpdi.dialog = function(){
        return $('.popupaskp') ;
    }
    
    askpdi.show = function(){
        askpdi.dialog().show() ;
    }
    
    askpdi.hide = function(){
        askpdi.dialog().hide() ;
        
        if(!askpdi.callbacks.hide) return ;
        askpdi.callbacks.hide() ;
        askpdi.callbacks.hide = null ;
    }
    
    askpdi.emsg = function(rootobj,msg){
        var msgdom = rootobj.find('.askperror') ;
        msgdom.html(msg) ;
        
        if(askpdi.st) clearTimeout(askpdi.st) ;
        askpdi.st = setTimeout(function(){
            msgdom.html('') ;
        },2000) ;
    }
    
    askpdi.postData = function(rootobj){
        var post = { } ;
        post.name = rootobj.find('.askp_name_name').val() ;
        post.phone = rootobj.find('.askp_name_phone').val() ;
        // post.province_id = rootobj.find('.askp_name_province').val() ;
        // post.city_id = rootobj.find('.askp_name_city').val() ;
        // 
        post.citytxt = rootobj.find('.askp_name_citytxt').val() ; 
        post.province_id = rootobj.find('.askp_name_province_id').val() ;
        post.city_id = rootobj.find('.askp_name_city_id').val() ;
        post.town_id = rootobj.find('.askp_name_town_id').val() ;

        post.product_id = rootobj.find('.askp_name_product_id').val() ;
        post.product_ids = rootobj.find('.askp_name_product_ids').val() ;
        post.product_title = rootobj.find('.askp_name_product_title').val() ;
        post.title = rootobj.find('.askp_name_title').val() ;
        post.content = rootobj.find('.askp_name_content').val() ;

        var filtmcval = rootobj.find('.askp_name_filtmc').val() ;
        if(filtmcval) post.filtmc = filtmcval ;
        if(post.filtmc) post.content += " 适配整机型号："+post.filtmc;

        post.ucompany = '个人' ;

        if(rootobj.find('.askp_person_buy_label input:checked').val() == 2) post.ucompany = rootobj.find('.askp_name_ucompany').val() ;
        
        var cdate = new Date();
        cdate.setTime(cdate.getTime() + (86400 * 1000 * 1000));
        
        var cks = ['name','phone','citytxt','ucompany','filtmc'] ;
        for(var i=0;i<cks.length;i++){
            var k = cks[i] ;
            if(typeof post[k] == 'undefined') continue ;
            b.Cookies.set('ak_' + k,post[k],cdate,'/','.lmjx.net',true) ;
        }
        
        if(!post.name){
            askpdi.emsg(rootobj,'请填写您的姓名') ;
            return false ;
        }
        
        if(!post.phone){
            askpdi.emsg(rootobj,'请填写您的联系电话') ;
            return false ;
        }
        
        if(!post.province_id || post.province_id == 0){
            askpdi.emsg(rootobj,'请选择所在省份') ;
            return false ;
        }
        
        if(!post.city_id || post.city_id == 0){
            askpdi.emsg(rootobj,'请选择所在城市') ;
            return false ;
        }
        
        
        //是否是公司购买
        if(rootobj.find('.askp_person_buy_label input:checked').val() == 2){
            if(!post.ucompany){
                askpdi.emsg(rootobj,'请填写公司名称') ;
                return false ;
            }
        }
        
        if(post.product_ids) post.product_ids = post.product_ids.replace(post.product_id+',','').replace(','+post.product_id,'').replace(post.product_id,'') ;

        if(window.RECENTVIEW_JSCF) post.recentview = window.RECENTVIEW_JSCF ;
        
        return post ;
    }
    
    askpdi.subm = function(rootobj){
        if(askpdi.xing) return ;
        
        var post = askpdi.postData(rootobj) ;
        if(!post) return false ;
        
        askpdi.xing = true ;
        rootobj.find('.askperror').html('数据提交中...') ;
    
        $.post('/z5/askp/post',post,function(js){
            if(!js || !js.code){
                askpdi.xing = false ;
                askpdi.emsg(rootobj,'网络错误，请重试') ;
                return false ;
            }
            if(js.code != '200'){
                askpdi.xing = false ;
                var msg = '网络错误，请重试' ;
                if(js.msg) msg = js.msg ;
                askpdi.emsg(rootobj,msg) ;
                return false ;
            }
            
            var askp_id = js.data.ids.join(',');
            var bdata = [];
            
            bdata.push({stag:'name',aval:post.name,source:'product_id='+post.product_id+'&askp_id='+askp_id})
            bdata.push({stag:'phone',aval:post.phone,source:'product_id='+post.product_id+'&askp_id='+askp_id})
            if(post.city_id) bdata.push({stag:'city_id',aval:post.city_id,source:'product_id='+post.product_id+'&askp_id='+askp_id})

            window.__bigPingAskp && window.__bigPingAskp(askp_id);

            //成功回调
            if(askpdi.callbacks.succ){
                askpdi.callbacks.succ(rootobj,js.data) ;
                askpdi.callbacks.succ = null ;
            }
            
            //一次询价多个数据，不再精准营销展示了
            if(post.product_ids && js.data.ids[0]){
                var askpId = js.data.ids[0] ;
                $.post('/z5/askp/batchpost',{product_id:post.product_ids,askp_id:askpId},function(ajs){
                    if(ajs && ajs.data && ajs.data.ids) window.__bigPingAskp && window.__bigPingAskp(ajs.data.ids.join(','));
                    
                    
                    askpdi.emsg(rootobj,'提交成功!') ;
                    askpdi.hide() ;
                    
                    askpdi.succ(js.data) ;
                    askpdi.xing = false ;
                    
                    if(!askpdi.callbacks.libatchpost) return ;
                    
                    askpdi.callbacks.libatchpost(rootobj,js.data) ;
                    askpdi.callbacks.libatchpost = null ;
                },'json') ;
                
                return ;
            }
            
            
            //精准营销展示
            $.post('/z5/accurate/json',{product_id:post.product_id},function(ajs){
                askpdi.emsg(rootobj,'提交成功!') ;
                askpdi.hide() ;
                
                askpdi.succ(js.data,ajs) ;
                askpdi.xing = false ;
            },'json') ;
            

        },'json') ;
    }
    
    askpdi.succ = function(data,adata){
        popaskpsucc.find('.btnwrap .other').html('查看更多' + data.pcate.name).attr('href','https://zj.lmjx.net/' + data.pcate.tag + '/') ;
        popaskpsucc.show() ;
        
        if(!adata || !adata.code || adata.code != '200') return ;
        
        //没有精准营销
        if(popaskpsucc.find('.otheraskp')[0]) return ;
        
        var askp_id = 0 ;
        if(data.ids[0]) askp_id = data.ids[0] ;
        
        var city_id = 0 ;
        var province_id = 0 ;
        if(data.area){
            var area = data.area ;
            if(area.city && area.city.id) city_id = area.city.id + '';
            if(area.province && area.province.id) province_id = area.province.id + '';
        }
        
        var pss = [] ;
        for(var i=0;i<adata.data.length;i++){
            var ad = adata.data[i] ;
            if(ad.city_ids){
                if(ad.city_ids.indexOf(city_id) < 0) continue ;
            }else if(ad.province_ids){
                if(ad.province_ids.indexOf(province_id) < 0) continue ;
            }
            
            pss.push(ad) ;
        }
        
        if(pss.length > 4) pss = pss.slice(0,4) ;
        if(pss.length < 1) return  ;
        
        var odom = $('<div class="otheraskp"></div>') ;
        odom.append($('<div class="inline"><h2>关注'+data.pproduct.title+'的用户还关注了... </h2><span>您可以对以下设备同时询价</span></div>')) ;
        
            
        var odomin = $('<div class="otherpro cl"></div>') ;
        odom.append(odomin) ;
        for(var i=0;i<pss.length;i++){
            var ad = pss[i] ;
            
            var addom = $('<div class="item"><a href="'+ad.url+'" target="_blank"><img src="'+ad.icon+'" alt="'+ad.title+'"></a><h2><a href="'+ad.url+'">'+ad.company_sname + ad.model +'</a></h2><div class="moreinf"><a href="'+ad.url+'param/" target="_blank">参数</a><a href="'+ad.url+'photo/" target="_blank">图片</a><a href="'+ad.url+'koubei/" target="_blank">口碑</a></div><label class="itempk"><input type="checkbox" checked="checked" data-company_sname="'+ad.company_sname+'" data-askpid="'+askp_id+'" data-id="'+ad.id+'" /></label></div>') ;

            odomin.append(addom) ;
        }
        
        var btndom = $('<div class="btnwrap1"><a href="javascript:;" class="toclose">关闭</a><a href="javascript:;" class="askp">一键询价</a></div>') ;
        odom.append(btndom) ;
        
        btndom.find('.askp').bind('click',function(){
            askpdi.onekeyfaskp() ;
        }) ;
        btndom.find('.toclose').bind('click',function(){
            popaskpsucc.hide() ;
        }) ;
        
        popaskpsucc.find('.askpsuccess').append(odom) ;
    }
    
    
    askpdi.onekeyfaskp = function(){
        var productIds = [] ;
        var askpId = 0 ;
        var companySnames = [] ;
        popaskpsucc.find('.otheraskp .itempk input:checked').each(function(){
            productIds.push($(this).attr('data-id')) ;
            
            if($(this).attr('data-askpid')) askpId = $(this).attr('data-askpid') ;
            if($(this).attr('data-company_sname')) companySnames.push($(this).attr('data-company_sname')) ;
        }) ;

        if(productIds.length < 1) return ;

        $.post('/z5/askp/batchpost',{product_id:productIds.join(','),askp_id:askpId},function(js){
            if(!js || !js.code || js.code != '200'){
                alert('网络错误，请重试！') ;
                return false ;
            }
            
            if(js && js.data && js.data.ids) window.__bigPingAskp && window.__bigPingAskp(js.data.ids.join(','));

            if(!askpdi._onkeyfaskpSuccDom){
                askpdi._onkeyfaskpSuccDom = $('<div class="popupaskpsuccess" style="display:none;"><div class="popupaskpsuccess_cover"></div><div class="askpsuccess"><span class="askpsuccess_icon"></span><div>您已同时询价了<span class="__"></span>，厂家会尽快与您联系！</div><div class="btnwrap"><a href="javascript:;" class="other" style="margin-left:0;">我知道了</a></div></div></div>') ;

                askpdi._onkeyfaskpSuccDom.find('.btnwrap .other').bind('click',function(){
                    askpdi._onkeyfaskpSuccDom.hide() ;
                }) ;

                $('body').append(askpdi._onkeyfaskpSuccDom) ;
            }

            askpdi._onkeyfaskpSuccDom.find('.__').html(companySnames.join('、')) ;
            askpdi._onkeyfaskpSuccDom.show() ;
            
            popaskpsucc.hide() ;

            return false ;
        
        },'json') ;
    }
    
    $('.showaskpbox').bind('click',function(){
        askpdi.show() ;
    }) ;

    var domprovince = $('.area_1') ;
    domprovince.append('<option value="">请选择省份</option>') ;
    for(var k in window.JSAreaData.provinces){
        var aprovince = {name:window.JSAreaData.provinces[k],id:k} ;
        var aoption = $('<option />') ;
        aoption.text(aprovince.name) ;
        aoption.val(aprovince.id) ;
        
        domprovince.append(aoption) ;
    }
    
    var funcProvinceChange = function(){
        var provinceId = $(this).val() ;
        var citys = window.JSAreaData.citys[provinceId] ;
        for(var i=0;i<domcity.length;i++){
            if(domcity[i]) domcity[i].options.length = 0 ;
        }
        
        var lcitys = [] ;
        if(citys){
            for(var k in citys){
                if(!k || !citys[k]) continue ;
                var acity = {name:citys[k],id:k} ;
                lcitys.push(acity) ;
            }
        }
        
        if(lcitys.length < 1) lcitys.push({id:provinceId,name:window.JSAreaData.provinces[provinceId]}) ;
        if(lcitys.length > 1) domcity.append('<option value="">请选择城市</option>') ;
        for(var i=0;i<lcitys.length;i++){
            var acity = lcitys[i] ;
            var aoption = $('<option />') ;
            aoption.text(acity.name) ;
            aoption.val(acity.id) ;
            
            domcity.append(aoption) ;
        }
        
    } ;
    
    var domcity = $('.area_2') ;
    domcity.append('<option>请选择城市</option>') ;
    domprovince.bind('change',funcProvinceChange) ;
    
    
    
    
    var popaskp = $('.popupaskp') ;
    popaskp.find('.close').bind('click',function(){
        askpdi.hide() ;
        return false ;
    }) ;
    
    $('.askp_person_buy_label input').bind('click',function(){
        var val = $(this).val() ;
        $('.askp_person_buy_label input').attr('checked',false) ;
        $('.askp_person_buy_label input[value='+val+']').attr('checked',true) ;
            
        if(val == '1'){
            $('.it_company').slideUp() ;
        }else{
            $('.it_company').slideDown() ;
        }
    }) ;
    
    
    $('.askpbox .more').bind('click',function(){
        if($(this).hasClass('open')){
            $(this).parent().find('.it-content').slideUp() ;
            $(this).removeClass('open') ;
            $(this).html('更多') ;
        }else{
            $(this).parent().find('.it-content').slideDown() ;
            $(this).addClass('open') ;
            $(this).html('收起') ;
        }
    }) ;
    
    $('.askp_name_submit').bind('click',function(){
        askpdi.subm($(this).parent().parent()) ;
    }) ;
    
    
    //还原
    var askpdata = {} ;
    var cks = ['name','phone','citytxt','ucompany','filtmc'] ;
    for(var i=0;i<cks.length;i++){
        var k = cks[i] ;
        if(!b.Cookies.get('ak_'+k)) continue ;
        
        askpdata[k] = b.Cookies.get('ak_'+k) ;
    }

    if(askpdata.name) $('.askp_name_name').val(askpdata.name) ;
    if(askpdata.filtmc) $('.askp_name_filtmc').val(askpdata.filtmc) ;
    if(askpdata.phone) $('.askp_name_phone').val(askpdata.phone) ;

    if(askpdata.citytxt) $('[data-toggle="city-picker"]').val(askpdata.citytxt) ;


    // if(askpdata.province_id){
    //  $('.area_1').val(askpdata.province_id) ;
    //  $('.area_1').map(function(){
    //      funcProvinceChange.call(this) ; 
    //  }) ;
    //  if(askpdata.city_id) $('.area_2').val(askpdata.city_id) ;
    // }
    if(askpdata.ucompany  && askpdata.ucompany != '个人'){
        $('.askp_name_ucompany').val(askpdata.ucompany) ;
        $('.askp_person_buy_label input').attr('checked',false) ;
        $('.askp_person_buy_label input[value=2]').attr('checked',true) ;
        $('.it_company').show() ;
    }
    
    //
    var popaskpsucc = $('<div class="popupaskpsuccess" style="display:none;"><div class="popupaskpsuccess_cover"></div><div class="askpsuccess"><span class="askpsuccess_icon"></span><div>您在中国路面机械网询价已发出，厂家的相关人员将会第一时间和您联系！</div><div class="btnwrap"><a href="javascript:;" class="continue">继续选型</a><a href="javascript:;" class="other">其他</a></div></div></div>') ;
    
    $('body').append(popaskpsucc) ;
    
    popaskpsucc.find('.btnwrap .continue').bind('click',function(){
        popaskpsucc.hide() ;
    }) ;
    
    
    
    
    $('.askaproduct').bind('click',function(){
        if($(this).hasClass('disabled')) return ;
        
        var oproductId = askpdi.dialog().find('.askp_name_product_id').val() ;
        var productId = $(this).attr('product_id') ;
        askpdi.dialog().find('.askp_name_title').val('') ;
        askpdi.dialog().find('.askp_name_product_id').val(productId) ;
        askpdi.dialog().find('.askp_name_product_ids').val('') ;
        askpdi.dialog().find('.askp_name_product_title').val('') ;
        
        askpdi.show() ;
        
        var that = this ;
        askpdi.callbacks.succ = function(){
            $(that).addClass('disabled').html('已询价') ;
            
            if(oproductId) askpdi.dialog().find('.askp_name_product_id').val(oproductId) ;
        } ;
        
        askpdi.callbacks.hide =  function(){
            if(oproductId) askpdi.dialog().find('.askp_name_product_id').val(oproductId) ;
        } ;
        
    }) ;
    
    
    
    //图片详情页
    var fimg = function(){
        if(!$(this).width() || !$(this).height()) return ;
        if($(this).width() == 1 || $(this).height() == 1) return ;

        if($(this).width() < $(this).height()) $(this).addClass('himg') ;
        else $(this).addClass('wimg') ;
    }
    
    $('.photos img').each(function(){
        fimg.call(this) ;
    }).bind('load',fimg) ;
    
    $('.gphotos img').each(function(){
        fimg.call(this) ;
    }).bind('load',fimg) ;
    
    if($('.gphotos img').size() > 0){
        $.getScript('https://u-static.lmjx.net/js/baguetteBox.min.js',function(){
            $('head').append($('<link rel="stylesheet" type="text/css" href="https://u-static.lmjx.net/css/baguetteBox.min.css" />')) ;
            baguetteBox.run('.gphotos .images') ;
        },true) ;
    }
    
    
    
    //参数详情页
    $('.dparam .item').each(function(){
        $(this).find('.acol').each(function(i){
            $(this).attr('ii',i).addClass('acolii'+i) ;
        }) ;
    }) ;
    
    $('.dparam .item .acol').hover(function(){
        $('.dparam .acolii'+$(this).attr('ii')).addClass('hover') ;
    },function(){
        $('.dparam .acolii'+$(this).attr('ii')).removeClass('hover') ;
    }) ;
    
    
    
    
    //
    $('.dparam .onekeyaskp').bind('click',function(){
        if($(this).hasClass('disabled')) return ;
        
        var dpproduct_ids = [] ;
        $('.dparam .askpbtn').each(function(){
            if($(this).hasClass('disabled')) return ;
            
            dpproduct_ids.push($(this).attr('product_id')) ;
        }) ;
        
        var that = this ;
        askpdi.dialog().find('.askp_name_product_ids').val(dpproduct_ids) ;
        askpdi.show() ;
        askpdi.callbacks.libatchpost = function(){
            $(that).addClass('disabled').find('a').html('已询价') ;
            askpdi.dialog().find('.askp_name_product_ids').val('') ;
            
            $('.dparam .askpbtn').each(function(){
                $(this).addClass('disabled').html('已询价') ;
            }) ;
        } ;
        
        
        askpdi.callbacks.hide = function(){
            askpdi.dialog().find('.askp_name_product_ids').val('') ;
        }
    }) ;
    
    if($('.dpdealers .item').size() > 0){
        function selIPs(){
            var aarea = $(this).val() ;
            if(!$('.dpdealers .item')) return $('.dpdealers .item').show() ;
            if(aarea) $(this).next('span').html('以下是'+ aarea + '地区相关销售电话') ;
            else $(this).next('span').html('') ;

            var dpdealersitemi = 0;
            $('.dpdealers .item').each(function(){
                var vdpvarea = $(this).find('.dpvarea').text() ;
                if(vdpvarea.indexOf('全部') > -1){
                    dpdealersitemi++;
                    $(this).show() ;
                    return ;
                }
            
                if(vdpvarea == '不限'){
                    dpdealersitemi++;
                    $(this).show() ;
                    return ;
                }

                if(aarea == '海外' && vdpvarea.indexOf('国外') > -1){
                    dpdealersitemi++;
                    $(this).show() ;
                    return ;
                }
                
                if(vdpvarea == '全国' || vdpvarea == '中国' || vdpvarea == '国内'){
                    dpdealersitemi++;
                    $(this).show() ;
                    return ;
                }
                
                if(vdpvarea.indexOf(aarea) > -1){
                    dpdealersitemi++;
                    $(this).show() ;
                    return ;
                }

                $(this).hide() ;
            }) ;

            if(dpdealersitemi>1) $('.dpdealers .item.default').hide() ;
        }

        $('.dprice_area_p').bind('change',selIPs) ;

        $.post('/z5/api/iparea','',function(js){
            if(!js || !js.code || js.code != '200') return ;
            if(!js.data || !js.data.area) return ;

            var iparea = js.data.area ;
            var aarea = '' ;
            $('.dprice_area_p option').each(function(){
                var atext = $(this).text() ;
                if(iparea.indexOf(atext) > -1){
                    aarea = atext ;
                    return false ;
                }
            }) ;
            
            if(!aarea) return ;

            $('.dprice_area_p').val(aarea) ;
            selIPs.call($('.dprice_area_p')[0]) ;
            
        },'json') ;
    }
    
    var lastdulikesli = false ;
    $('.dulikes li').bind('mouseover',function(){
        if(lastdulikesli) $(lastdulikesli).removeClass('hover') ;
        $(this).addClass('hover') ;
        
        lastdulikesli = this ;
    }) ;
    
    if($('.dulikes li')[0]){
        lastdulikesli = $('.dulikes li')[0] ;
        $(lastdulikesli).addClass('hover') ;
    }
    
    
    if($('.apk').size() > 0){
        pkbar() ;
        $('.apk').bind('click',function(){
            var item = {} ;
            item.id = $(this).attr('iid') ;
            item.icon = $(this).attr('icon') ;
            item.cname = $(this).attr('cname') ;
            item.model = $(this).attr('model') ;
            item.url = $(this).attr('href') ;
            item.cate_id = $(this).attr('cate_id') ;
            item.cate_name = $(this).attr('cate_name') ;
            
            pktools.add(item.id,item.icon,item.cname,item.model,item.url,item.cate_id,item.cate_name) ;
            return false ;
        }) ;
    }
    
    
    //首页，查看销售电话
    $('.shownetworkbox').bind('click',function(){
        loginplat.showLoginBox() ;
    }) ;

    $('.aqrcode').bind('click',function(){
        var doom = $(this).find('.img') ;
        if(!doom[0]){
            doom = $('<div class="img"><img src="/z5/api/qrcode/productdetail/'+$(this).attr('product_id')+'" /></div>')
            $(this).append(doom) ;
        }
        if(doom.css('display') == 'block') doom.fadeOut() ;
        else doom.fadeIn() ;
    }) ;
  
    $('.showpricetip').hover(function(){
        $(this).parent().siblings('.productpricel2tip').show() ;
    },function(){
        $(this).parent().siblings('.productpricel2tip').hide() ;
    }) ;
    
    // 对比 vs 
    jQuery(".contrastprolist").slide({titCell:".hd ul",mainCell:".bd .list",autoPage:true,effect:"left",autoPlay:true,vis:4,trigger:"click"});

    $('.contrastprolist .list .itempk').on('click', function () {
        var id = $(this).attr('data-id');
        var title = $(this).attr('data-title');
        var icon = $(this).attr('data-icon');

        var cart = $('.shopping-cart');
        var imgtodrag = $(this).parent().children('.icon').children('img');
        if (imgtodrag) {
            var imgclone = imgtodrag.clone().offset({
                top: imgtodrag.offset().top,
                left: imgtodrag.offset().left
            }).css({
                'opacity': '0.5',
                'position': 'absolute',
                'width': '200px',
                'z-index': '100'
            }).appendTo($('body')).animate({
                'top': cart.offset().top + 10,
                'left': cart.offset().left + 10,
                'width': 200,
                'height': 120,
                'opacity': 0
            }, 1000, 'easeInOutExpo');
            imgclone.animate({
                'width': 200,
                'height': 120,
                'opacity': 0
            }, function () {
                $(this).detach();
            });
        }

        setTimeout(function(){
            $('.contrastpro .item.fr').attr('data-id',id);
            $('.contrastpro .item.fr').children('.shopping-cart').children('img').attr('src',icon);
            $('.contrastpro .item.fr .itemin .title').text(title);
        },800)
    });

    $('.contrastpro .ivs .ivsdetail').on('click', function (){
        var pid1 = $('.contrastpro .item.fl').attr('data-id');
        var pid2 = $('.contrastpro .item.fr').attr('data-id');
        if(!pid1 || !pid2) return false;

        window.location.href = 'https://zj.lmjx.net/pk/'+pid1+'/'+pid2+'/';
        
    }); 
   
   (function(){
        
        var sf = {
            video : function(adata,e){
                if(sf._lastId == adata.id){
                    $('.dtop .dtopl .bd').find('.videobox video').trigger('play');
                    $('.dtop .dtopl .bd').find('.videobox').show();
                    return ;
                }
                
                var tpl = '<div class="dphoto"><i class="nplay"></i>'
                    + '<div class="videobox"><video src="{url}" poster="{icon}" controls></video><a href="javascript:;" class="videoclose"></a></div>'
                    + '<img src="{icon}" alt="{name}" /></div>';
                var adom = $(sf.retpl(tpl,adata)) ;
                
                $('.dtop .dtopl .bd').html('').append(adom)  ;
                
                adom.find('.nplay').click(function(){
                    adom.find('.videobox video').trigger('play');
                    adom.find('.videobox').show();
                });

                adom.find('.videobox .videoclose').click(function(){
                    adom.find('.videobox video').trigger('pause');
                    $(this).parent().hide();
                });
                
                if(!e) return ;
                
                try{
                    adom.find('.videobox video').trigger('play');
                    adom.find('.videobox').show();
                }catch(e){
                    
                }
            },
            
            _dphoto : function(adata){
                var tpl = '<div class="dphoto"><img src="{icon}" alt="{name}" /><a href="{url}" class="amore">查看更多图片&gt;&gt;</a></div>' ;
                var adom = $(sf.retpl(tpl,adata)) ;
                
                $('.dtop .dtopl .bd').html('').append(adom)  ;
                
            },
            
            oth : function(adata,e){
                adata.ifurl = adata.url + (adata.url.indexOf('?') > -1 ? '&' : '?') + 'pheight=350&pwidth=500' ;
                
                if(!e){
                    var _tmpd = $('.dtop .dtopl .bd .dphoto iframe')[0] ;
                    if(_tmpd && $(_tmpd).attr('src') == adata.ifurl) return ;
                }
                
                var tpl = '<div class="dphoto"><iframe src="{ifurl}" frameborder="0" style="border:0;width:100%;height:350px;" width="100%" height="350"></iframe>' ;
                var adom = $(sf.retpl(tpl,adata)) ;
                $('.dtop .dtopl .bd').html('').append(adom)  ;
            },
            
            _amore : function(adata){
                return true ;
            },
            
            retpl : function(tpl,adata){
                var html = tpl ;
                for(var k in adata){
                    html = html.replace(new RegExp('{'+k+'}','gm'),adata[k]) ;
                }
                return html ;
            },
        } ;
        
        function clickFn(e){
            var aid = $(this).attr('data-id') ;
            var aname = $(this).attr('data-name') ;
            var aicon = $(this).attr('data-icon') ;
            var aurl = $(this).attr('data-url') ;
            var amodname = $(this).attr('data-modname') ;
            
            var adata = { id : aid, name: aname , icon: aicon , url : aurl , modname: amodname };
            
            var func = sf[adata.modname] ? sf[adata.modname] : sf.oth ;
            
            func(adata,e) ;
            sf._lastId = aid ;
        } ;
        
        var asize = $('.dtop .hd .imgstype .item').size() ;
        if(asize < 1) return ;
        
        if(asize < 5) $('.gphotos .gitem').each(function(){
            if(asize > 4) return false ;
            
            var _h3 = $(this).find('h3') ;
            
            var aname = _h3.text().split('（')[0] ;
            var aurl = $('.dphoto .amore').attr('href') +'#' + $(this).attr('id') ;
            var daicon = $(_h3.parent().find('.images img')[0]) ;
            var icon = (daicon.attr('data-original') ? daicon.attr('data-original') : daicon.attr('src')).split('!')[0] ;
            var icon300 = icon + '!' + '300x300.jpg' ;
            
            var tpl = '<li class="item" data-id="{id}" data-icon="{icon}" data-name="{name}" data-url="{url}" data-modname="_amore">'
                    + '<a href="{url}"><img class="img" src="{icon300}" alt="{name}">'
                    + '<span class="name">{name}</span></a></li>' ;
                    
            if(_h3.text().indexOf('外观') > -1){
                icon = $('.amoreimgpic').attr('src');
                tpl = '<li class="item" data-id="{id}" data-icon="{icon}" data-name="{name}" data-url="{url}" data-modname="_dphoto">'
                    + '<img class="img" src="{icon300}" alt="{name}">'
                    + '<span class="name">{name}</span></li>' ;
                aurl = $('.dphoto .amore').attr('href');
            }
            
            var adata = { name : aname , url : aurl , id:Math.random() , icon: icon ,icon300:icon300  } ;

            var adom = $(sf.retpl(tpl,adata)) ;
            $('.dtop .hd .imgstype').append(adom) ;
            
            asize++ ;
        }) ;
        
        $('.dtop .hd .imgstype .item').bind('click',clickFn) ;
        clickFn.call($('.dtop .hd .imgstype .item')[0]) ;
    })();
    

    //询价/最新浏览
    if(window.Pid) $.getScript('https://zj.lmjx.net/recentview/jscf.php') ;
    
    if(window.location.href.indexOf('#askp') > -1) askpdi.show() ;
    
    var iaudioplay = false ;
    function auto_detail_audio_play(that){
        if(iaudioplay){
            $('#detail-index-audio')[0].pause() ;
            iaudioplay = false;
            that.removeClass('vplaying') ; 
            that.children('span').text('为您语音讲解设备');
            return ;
        }

        $('#detail-index-audio')[0].play() ;
        that.addClass('vplaying') ;  
        that.children('span').text('正在为您语音讲解设备');
        iaudioplay = true;
    }

    $('#detail-index-audio-voicebtn').click(function(){
        var that = $(this);
        auto_detail_audio_play(that);   
    })

    var detailindexaudiod = document.getElementById("detail-index-audio");
    detailindexaudiod && detailindexaudiod.addEventListener('ended', function (){  
        auto_detail_audio_play($('#detail-index-audio-voicebtn'));
    }, false);
}


function start_company(){
    if($('.himages img').size() > 0){
        $.getScript('https://u-static.lmjx.net/js/baguetteBox.min.js',function(){
            $('head').append($('<link rel="stylesheet" type="text/css" href="https://u-static.lmjx.net/css/baguetteBox.min.css" />')) ;
            baguetteBox.run('.himages') ;
        },true) ;
    }
}

function googleTranslateElementInit() {
  // new google.translate.TranslateElement({pageLanguage: 'zh-CN', includedLanguages: 'en,ja,zh-CN', multilanguagePage: true}, 'google_translate_element');
    new google.translate.TranslateElement(
        {
            //这个是当前页面的原语言，便于插件精确翻译
            pageLanguage: 'zh-CN',
            //这个是你需要翻译的语言，比如你只需要翻译成越南和英语，这里就只写en,vi
            //en,zh-CN,hr,cs,da,nl,fr,de,el,iw,hu,ga,it,ja,ko,pt,ro,ru,sr,es,th,vi
            includedLanguages: '',
            //自动显示翻译横幅，就是翻译后顶部出现的那个，有点丑，这个属性没有用的话，请看文章底部的其他方法
            autodisplay: true, 
            //还有些其他参数，由于原插件不再维护，找不到详细api了
            //未知
            multilanguagePage: true
        }, 
        'google_translate_element'//触发按钮的id
    );
}

function pkbar(){
    $('#pktools_btn').bind('click',function(){
        $('#pkbox').toggle() ;
    }) ;
    
    var pktools = { } ;
    pktools.maxpknum = 4 ;
    pktools.add = function(id,icon,cname,model,url,cate_id,cate_name){
        if($('#pkbox .contlistin p').length >= pktools.maxpknum){
            alert('最多只能同时对比' + pktools.maxpknum + '款' + cate_name) ;
            return false;
        }
        
        $('#pkbox').show() ;
        
        pktools._add(id,icon,cname,model,url,cate_id,cate_name) ;
        pktools._figo() ;
        
        $.getScript('https://zj.lmjx.net/pk/op/' + cate_id + '/?op=add&id=' + id) ;
        return true ;
    }
    
    pktools._add = function(id,icon,cname,model,url,cate_id,cate_name){
        var aadom = $('<p class="it" id="_ipk_pkbox_item_'+id+'"><a href="'+url+'" target="_blank">'+cname+model+cate_name+'<a href="javascript:;" class="del"></a></p>') ;
        $('#pkbox .contlistin').append(aadom) ;
        
        $('#pkbox .contlist').show() ;
        $('#pkbox .contnone').hide() ;
        
        if(!$('#pktools_btn span')[0]) $('#pktools_btn').append($('<span></span>')) ;
        $('#pktools_btn span').html($('#pkbox .contlistin p').length) ;
        
        aadom.find('.del').bind('click',function(){
            pktools.sub(id,cate_id) ;
        }) ;
        
        return true ;
    }
    
    pktools._figo = function(){
        var ids = [ ] ;
        $('#pkbox .contlistin p').map(function(){
            var id = $(this).attr('id').replace('_ipk_pkbox_item_','') ;
            if(!id) return ;
            ids.push(id) ;
        }) ;
        
        var psize = ids.length ;
        if(psize < 1){
            $('#pkbox .contlist').hide() ;
            $('#pkbox .contnone').show() ;
            
            if($('#pktools_btn span')[0]) $('#pktools_btn span').remove() ;
            return ;
        }
        
        if(psize < 2) $('#pkbox .contbtn').hide() ;
        $('#pktools_btn span').html(psize) ;
        
        $('#pkbox .contbtn').attr('href','https://zj.lmjx.net/pk/'+ids.join('/')+'/').show() ;
    }
    
    pktools.sub = function(id,cate_id){
        if(!$('#_ipk_pkbox_item_'+id)[0]) return false ;
        
        $('#_ipk_pkbox_item_'+id).remove() ;
        $('#pkbox').show() ;
                
        pktools._figo() ;
        $.getScript('https://zj.lmjx.net/pk/op/' + cate_id + '/?op=sub&id=' + id) ;
        return true ;
    }
    
    pktools.show = function(cate_id,cate_name){
        $.getScript('https://zj.lmjx.net/pk/op/' + cate_id + '/?op=show',function(){
            if(!window['OPPK_'+cate_id] || !window['OPPK_'+cate_id].list || window['OPPK_'+cate_id].list.length < 1) return ;
            
            for(var i=0;i<window['OPPK_'+cate_id].list.length;i++){
                var aitem = window['OPPK_'+cate_id].list[i] ;
                $('#itempk_inputcheck_'+aitem.id).attr('checked',true) ;
                pktools._add(aitem.id,aitem.img,aitem.cn_brand,aitem.model,aitem.url,cate_id,cate_name)
            }
            
            pktools._figo() ;
        }) ;
    }
    
    pktools.clear = function(cate_id){
        $('#pkbox .contlistin p').map(function(){
            var id = $(this).attr('id').replace('_ipk_pkbox_item_','') ;
            if(!id) return ;
            
            $('#itempk_inputcheck_'+id).attr('checked',false) ;
        }) ;
        $('#pkbox .contlistin p').remove() ;
        pktools._figo() ;
        $.getScript('https://zj.lmjx.net/pk/op/' + cate_id + '/?op=clear') ;
    }
    
    
    if(window.VCate && window.VCate.id){
        pktools.show(window.VCate.id,window.VCate.name) ;
        
        $('#pkbox .reseta').bind('click',function(){
            pktools.clear(window.VCate.id) ;
        }) ;
    }
    
    
    //返回顶部
    $('.backtop').click(function(){
        $('html,body').animate({scrollTop:0},'slow') ;
    }) ;
    
    window.pktools = pktools ;
}


function stat(){
    var ps = [] ;
    if(window.Pc1) ps.push('c1='+window.Pc1) ; 
    if(window.Pc2) ps.push('c2='+window.Pc2) ; 
    if(window.Pcc) ps.push('cc='+window.Pcc) ; 
    if(window.Pid) ps.push('dd='+window.Pid) ; 
    if(window.VP) ps.push('vp='+window.VP) ;
    if(window.VPC) ps.push('vpc='+window.VPC) ;
    
    if(!window.Pfp){
        var referrers = {'baidu.com':1,'google.com':2,'so.com':3,'sogou.com':4,'bing.com':5,'yahoo.com':6};
        for(var i in referrers){
            if(document.referrer.indexOf(i)!=-1){
                window.Pfp = referrers[i] ;
                break ;
            }
        }
    }
    
    if(window.Pfp) ps.push('pfp='+window.Pfp) ;
    
    
    
    if(ps.length < 1) return ;
    $.getScript('https://zj.lmjx.net/recentview/?' + ps.join('&')) ;

    if(document.referrer) ps.push('__ref__=' + encodeURIComponent(document.referrer)) ;
    $.getScript('https://statcenter-zj.lmjx.net/z5' + (ps.length > 0 ? ('?' + ps.join('&')) : '')) ;

    ps = [] ;
    if(document.referrer) ps.push('ref=' + encodeURIComponent(document.referrer)) ;
    $.getScript('https://zj.lmjx.net/statcenter/' + (ps.length > 0 ? ('?' + ps.join('&')) : '')) ;
}


function xbase(){
    var Cookies = {};  
    Cookies.set = function(name, value){  
         var argv = arguments;  
         var argc = arguments.length;  
         var expires = (argc > 2) ? argv[2] : null;  
         var path = (argc > 3) ? argv[3] : '/';  
         var domain = (argc > 4) ? argv[4] : null;  
         var secure = (argc > 5) ? argv[5] : false;  
         document.cookie = name + "=" + escape (value) +  
           ((expires == null) ? "" : ("; expires=" + expires.toGMTString())) +  
           ((path == null) ? "" : ("; path=" + path)) +  
           ((domain == null) ? "" : ("; domain=" + domain)) +  
           ((secure == true) ? "; secure" : "");  
    };  
      
    Cookies.get = function(name){  
        var arg = name + "=";  
        var alen = arg.length;  
        var clen = document.cookie.length;  
        var i = 0;  
        var j = 0;  
        while(i < clen){  
            j = i + alen;  
            if (document.cookie.substring(i, j) == arg)  
                return Cookies.getCookieVal(j);  
            i = document.cookie.indexOf(" ", i) + 1;  
            if(i == 0)  
                break;  
        }  
        return null;  
    };  
      
    Cookies.clear = function(name) {  
      if(Cookies.get(name)){  
        document.cookie = name + "=" +  
        "; expires=Thu, 01-Jan-70 00:00:01 GMT";  
      }  
    };  
    
    Cookies.getCookieVal = function(offset){  
    var endstr = document.cookie.indexOf(";", offset);  
    if(endstr == -1){  
       endstr = document.cookie.length;  
    }  
    return unescape(document.cookie.substring(offset, endstr));  
    };
    
    return {Cookies:Cookies} ;
}


(function(){
    var initJss = ['https://u-static.lmjx.net/js/jquery.lazyload.min.js','https://u-static.lmjx.net/js/u.js','https://u-static.lmjx.net/js/areadata.js','https://u-static.lmjx.net/2021/sosuggest/js/pc.js','https://u-static.lmjx.net/js/jquery.SuperSlide.2.1.1.js'] ;
    
    var scriptNode = document.createElement("script");
    scriptNode.type = "text/javascript";
    scriptNode.src = 'https://u-static.lmjx.net/js/jquery.min.js' ;
    scriptNode.onreadystatechange = scriptNode.onload = function(){
        if(!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete'){
            
            $.getScript = function(url, callback, cache) {
                $.ajax({type: 'GET', url: url, success: callback, dataType: 'script', ifModified: true, cache: cache});
            };
            function _l(){
                if(initJss.length < 1) return start() ;
                
                var u = initJss.shift() ;
                $.getScript(u,_l,true) ;
            }
            
            _l() ;
            
            scriptNode.onreadystatechange = scriptNode.onload = null;
            scriptNode.parentNode.removeChild(scriptNode);
        };
    };

    document.getElementsByTagName('head')[0].appendChild(scriptNode);
})() ;




(function() {
  var hm = document.createElement("script");
  hm.src = "https://u-static.lmjx.net/js/rping.js";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();


var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b8d685390507032b596bace98b0683fe";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();